-- database: c:\Users\joshu\Documents\rust_projects\deadball_league_generator\deadball.db

-- Use the â–· button in the top right corner to run the entire file.

WITH home_team_info AS(
    SELECT game_id AS home_game_id, teams.team_name AS home_team, teams.team_score AS home_ts
    FROM games
    INNER JOIN teams ON teams.id = home_team_id
),

visiting_team_info AS(
    SELECT game_id AS away_game_id, teams.team_name AS away_team, teams.team_score AS away_ts
    FROM games
    INNER JOIN teams ON teams.id = away_team_id
)

SELECT
    round_id,
    game_id, 
    home_team_info.home_team AS home_team, 
    home_team_info.home_ts AS home_ts,
    home_score,
    visiting_team_info.away_team AS away_team,
    visiting_team_info.away_ts AS away_ts,
    away_score
FROM
    games
INNER JOIN
    home_team_info ON home_team_info.home_game_id = game_id
INNER JOIN
    visiting_team_info ON visiting_team_info.away_game_id = game_id
;

