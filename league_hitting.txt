-- database: c:\Users\joshu\Documents\rust_projects\deadball_league_generator\deadball.db

-- Use the â–· button in the top right corner to run the entire file.
SELECT leagues.league_name,leagues.era as era, count(DISTINCT players.team_id) as team_count, 
avg(players.pd_int) as average_pd,
avg(teams.team_score) as average_team_score
FROM
leagues
INNER JOIN teams on teams.league_id = leagues.id
INNER JOIN players on players.team_id = teams.id
WHERE players.PD is NOT NULL
GROUP BY leagues.league_name
HAVING(team_count > 1)
ORDER BY average_pd DESC, team_score DESC


